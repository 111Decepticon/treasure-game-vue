import{_ as D,g as A,u as T,h as f,c as p,o as V,a as E,b as v,d as m,e,t as n,n as G,F as S,r as b,f as h,i as z}from"./index-9ee89850.js";import{u as I}from"./index-63dfe2fa.js";const P={name:"LocationView",setup(){const r=A(),i=T(),a=I(),t=f(0),c=f(!1),u=f(!1),s=f(null),l=f("任务尚未开始..."),d={library:{title:"古老图书馆",subtitle:"寻找初始线索",steps:[{title:"寻找古籍",content:"在古老的图书馆里寻找关于宝藏的第一个线索...",animation:"📚",quiz:null},{title:"解读古籍",content:"你找到了一本古籍，但需要解开书中的谜题...",animation:"🔍",quiz:{question:"古籍中哪个符号代表'宝藏'？",options:[{text:"⚡",correct:!1},{text:"💎",correct:!0},{text:"🌙",correct:!1},{text:"🔥",correct:!1}]}}],resultSuccess:"成功找到线索: '当太阳与月亮相遇，宝石将指引方向'",resultFailure:"未能找到线索，需要再次尝试"},temple:{title:"失落神庙",subtitle:"解码古代文字",steps:[{title:"进入神庙",content:"根据线索，你来到了失落的神庙，寻找古代文字...",animation:"🏛️",quiz:null},{title:"解读文字",content:"你发现了刻在墙上的古代文字，需要正确解读...",animation:"🔍",quiz:{question:"古代文字中哪个图案代表'入口'？",options:[{text:"🚪",correct:!0},{text:"🔑",correct:!1},{text:"🗝️",correct:!1},{text:"🔒",correct:!1}]}}],resultSuccess:"成功解码! 线索指向神秘洞穴",resultFailure:"解码失败，需要重新尝试"},cave:{title:"神秘洞穴",subtitle:"避开守卫陷阱",steps:[{title:"进入洞穴",content:"你来到了神秘洞穴，需要小心避开守卫...",animation:"🕳️",quiz:null},{title:"避开陷阱",content:"洞穴中有古老的守卫机制，需要巧妙避开...",animation:"⚔️",quiz:{question:"如何避开洞穴中的陷阱？",options:[{text:"快速冲过去",correct:!1},{text:"沿着墙边行走",correct:!0},{text:"大声喊叫",correct:!1},{text:"闭上眼睛",correct:!1}]}}],resultSuccess:"成功避开守卫! 找到了一个神秘箱子",resultFailure:"被守卫发现，需要重新尝试"},beach:{title:"沉船海滩",subtitle:"寻找藏宝图",steps:[{title:"搜索海滩",content:"在沉船海滩上寻找可能的藏宝图...",animation:"🏖️",quiz:null},{title:"解读地图",content:"你找到了一张古老的地图，需要正确解读...",animation:"🗺️",quiz:{question:"地图上的X标记在哪里？",options:[{text:"棕榈树下",correct:!1},{text:"大石头下",correct:!0},{text:"沙滩中央",correct:!1},{text:"海浪边",correct:!1}]}}],resultSuccess:"成功找到藏宝图! 标记指向远古山脉",resultFailure:"未能找到藏宝图，需要再次搜索"},mountain:{title:"远古山脉",subtitle:"解读星象线索",steps:[{title:"攀登山脉",content:"你来到了远古山脉，寻找星象线索...",animation:"⛰️",quiz:null},{title:"观察星象",content:"在山顶观察星象，寻找宝藏的最终位置...",animation:"🔭",quiz:{question:"哪颗星星指向宝藏位置？",options:[{text:"北极星",correct:!1},{text:"北斗七星",correct:!0},{text:"天狼星",correct:!1},{text:"金星",correct:!1}]}}],resultSuccess:"成功解读星象! 宝藏就在前方的密室中",resultFailure:"星象解读错误，需要重新观察"},treasure:{title:"宝藏密室",subtitle:"打开宝藏箱",steps:[{title:"进入密室",content:"你终于来到了宝藏密室，找到了神秘的宝藏箱...",animation:"💎",quiz:null},{title:"打开宝箱",content:"宝藏箱上有最后的谜题，需要解开才能打开...",animation:"🎁",quiz:{question:"宝藏箱上的谜题：什么东西越洗越脏？",options:[{text:"衣服",correct:!1},{text:"水",correct:!0},{text:"肥皂",correct:!1},{text:"手",correct:!1}]}}],resultSuccess:"恭喜!你找到了传说中的宝藏——一颗发光的远古宝石!",resultFailure:"未能打开宝藏箱，需要重新尝试"}},o=p(()=>d[r.params.id]||null),_=p(()=>a.completedLocations.includes(r.params.id)),L=p(()=>o.value?(t.value+1)/o.value.steps.length*100:0),k=p(()=>_.value?"任务已完成":c.value?"任务进行中...":"开始任务"),y=()=>{_.value||c.value||(a.playSound("click"),c.value=!0,t.value=0,l.value="任务进行中...",u.value=!1,s.value=null,g())},g=()=>{if(!o.value)return;o.value.steps[t.value].quiz||setTimeout(()=>{t.value++,t.value<o.value.steps.length?g():x()},1500)},w=(q,F)=>{u.value||(a.playSound("click"),u.value=!0,s.value=q,setTimeout(()=>{F?(a.playSound("success"),t.value++,t.value<o.value.steps.length?(u.value=!1,s.value=null,g()):x()):(a.playSound("failure"),B())},1200))},x=()=>{a.completeLocation(r.params.id),l.value=o.value.resultSuccess,c.value=!1},B=()=>{a.failLocation(r.params.id),l.value=o.value.resultFailure,c.value=!1},C=()=>{a.playSound("click"),i.push("/")};return V(()=>{if(!o.value){i.push("/");return}a.locationBgmEnabled&&a.playLocationBgm(r.params.id),_.value&&(l.value=o.value.resultSuccess)}),E(()=>{a.stopBgm()}),{currentLocationData:o,currentStepIndex:t,isInProgress:c,showAnswer:u,selectedOption:s,resultMessage:l,gameStore:a,isCompleted:_,stepProgress:L,startButtonText:k,startLocationGame:y,handleAnswer:w,goBack:C}}},M={key:0,class:"location-view"},N={class:"container"},O={class:"subtitle"},R={class:"progress-bar"},U={class:"game-area"},X={class:"step-header"},j={class:"step-number"},H={class:"step-title"},J={class:"step-content"},K={key:0,class:"quiz-container"},Q={class:"quiz-question"},W={class:"quiz-options"},Y=["onClick","disabled"],Z={class:"step-animation"},$={class:"animation-icon"},tt={class:"treasure-result"},et={class:"controls"},st=["disabled"],ot={class:"audio-controls"};function at(r,i,a,t,c,u){return t.currentLocationData?(v(),m("div",M,[e("div",N,[e("header",null,[e("h1",null,n(t.currentLocationData.title),1),e("p",O,n(t.currentLocationData.subtitle),1)]),e("div",R,[e("div",{class:"progress",style:G({width:t.stepProgress+"%"})},null,4)]),e("div",U,[(v(!0),m(S,null,b(t.currentLocationData.steps,(s,l)=>(v(),m("div",{key:l,class:h(["step-card",{active:t.currentStepIndex===l}])},[e("div",X,[e("div",j,n(l+1),1),e("h2",H,n(s.title),1)]),e("div",J,[e("p",null,n(s.content),1)]),s.quiz&&t.currentStepIndex===l?(v(),m("div",K,[e("div",Q,n(s.quiz.question),1),e("div",W,[(v(!0),m(S,null,b(s.quiz.options,(d,o)=>(v(),m("button",{key:o,class:h(["quiz-option",{correct:t.showAnswer&&d.correct,incorrect:t.showAnswer&&t.selectedOption===o&&!d.correct}]),onClick:_=>t.handleAnswer(o,d.correct),disabled:t.showAnswer},n(d.text),11,Y))),128))])])):z("",!0),e("div",Z,[e("div",$,n(s.animation),1)])],2))),128))]),e("div",tt,n(t.resultMessage),1),e("div",et,[e("button",{onClick:i[0]||(i[0]=(...s)=>t.startLocationGame&&t.startLocationGame(...s)),disabled:t.isCompleted||t.isInProgress},n(t.startButtonText),9,st),e("button",{onClick:i[1]||(i[1]=(...s)=>t.goBack&&t.goBack(...s))}," 返回地图 ")]),e("div",ot,[e("button",{class:h(["audio-btn",{active:t.gameStore.locationBgmEnabled}]),onClick:i[2]||(i[2]=(...s)=>t.gameStore.toggleLocationBgm&&t.gameStore.toggleLocationBgm(...s))},n(t.gameStore.locationBgmEnabled?"🔊":"🔇")+" 地点音乐 ",3)]),e("footer",null,[e("div",null,n(t.currentLocationData.title)+" - "+n(t.currentLocationData.subtitle),1)])])])):z("",!0)}const it=D(P,[["render",at],["__scopeId","data-v-404cda9c"]]);export{it as default};
